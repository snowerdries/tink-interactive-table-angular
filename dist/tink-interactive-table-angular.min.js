/*! tink-interactive-table-angular v2.2.3 */
"use strict";!function(module){try{module=angular.module("tink.interactivetable")}catch(e){module=angular.module("tink.interactivetable",["tink.popover","tink.sorttable","ngLodash"])}module.directive("tinkPagination",["lodash",function(_){return{restrict:"EA",templateUrl:"templates/pagination.html",scope:{tinkTotalItems:"=",tinkItemsPerPage:"=",tinkItemsPerPageValues:"=",tinkCurrentPage:"=",tinkChange:"=",tinkPaginationId:"@"},controllerAs:"ctrl",controller:["$scope","$rootScope","$timeout",function($scope,$rootScope,timeout){function sendMessage(){$rootScope.$broadcast("tink-pagination-"+$scope.tinkPaginationId,"loading"),timeout(function(){$scope.tinkChange({type:"page",value:$scope.tinkCurrentPage},function(){$rootScope.$broadcast("tink-pagination-"+$scope.tinkPaginationId,"ready")})},0)}var ctrl=this;ctrl.itemsPerPage=function(){if($scope.tinkItemsPerPageValues&&$scope.tinkItemsPerPageValues instanceof Array&&$scope.tinkItemsPerPageValues.length>0)return-1===$scope.tinkItemsPerPageValues.indexOf(parseInt($scope.tinkItemsPerPage))&&($scope.tinkItemsPerPage=$scope.tinkItemsPerPageValues[0]),$scope.tinkItemsPerPageValues;var basic=[5,10,20,30];return-1===basic.indexOf(parseInt($scope.tinkItemsPerPage))&&($scope.tinkItemsPerPage=basic[0]),basic},ctrl.perPageChange=function(){$rootScope.$broadcast("tink-pagination-"+$scope.tinkPaginationId,"loading"),timeout(function(){$scope.tinkChange({type:"perPage",value:$scope.tinkItemsPerPage},function(){$rootScope.$broadcast("tink-pagination-"+$scope.tinkPaginationId,"ready")})},0)},ctrl.setPage=function(page){$scope.tinkCurrentPage=page,sendMessage()},ctrl.setPrev=function(){$scope.tinkCurrentPage>1&&($scope.tinkCurrentPage=$scope.tinkCurrentPage-1),sendMessage()},ctrl.setNext=function(){$scope.tinkCurrentPage<ctrl.pages&&($scope.tinkCurrentPage=$scope.tinkCurrentPage+1),sendMessage()},ctrl.calculatePages=function(){var num=$scope.tinkCurrentPage;ctrl.pages=Math.ceil($scope.tinkTotalItems/$scope.tinkItemsPerPage),(ctrl.pages<=0||void 0===ctrl.pages||null===ctrl.pages||isNaN(ctrl.pages))&&(ctrl.pages=1),num>ctrl.pages?num=$scope.tinkCurrentPage=ctrl.pages:(0>=num||void 0===num||null===num)&&($scope.tinkCurrentPage=1);var arrayNums;return ctrl.pages<6?arrayNums=_.range(2,ctrl.pages):4>num?(arrayNums=_.range(2,4),arrayNums.push(-1)):arrayNums=num>=ctrl.pages-2?[-1].concat(_.range(ctrl.pages-2,ctrl.pages)):[-1,num,-1],ctrl.pages>1&&arrayNums.push(ctrl.pages),arrayNums}}]}}]).filter("limitNum",[function(){return function(input,limit){return input>limit?limit:input}}]).filter("tinkMin",[function(){return function(input,limit){return void 0===limit&&(limit=0),limit>input?limit:input}}]).directive("tinkPaginationKey",["$rootScope",function(rootScope){return{link:function($scope,element,attrs){rootScope.$on("tink-pagination-"+attrs.tinkPaginationKey,function(e,value){"loading"===value?$(element).find("table.table-interactive").addClass("is-loading"):"ready"===value&&$(element).find("table.table-interactive").removeClass("is-loading")})}}}])}(),function(module){try{module=angular.module("tink.interactivetable")}catch(e){module=angular.module("tink.interactivetable",["tink.popover","tink.sorttable","ngLodash"])}module.directive("tinkInteractiveTable",["$compile","$rootScope","$filter",function($compile,$rootScope,$filter){return{restrict:"EA",templateUrl:"templates/reorder.html",scope:{ngModel:"=",tinkHeaders:"=",tinkActions:"=",tinkForceResponsive:"=",tinkColumnReorder:"=",tinkRowClick:"&",tinkChange:"&",tinkEmptyMessage:"@"},link:function(scope,element){function createCheckbox(row,i,hulp){hulp||(hulp="");var random=Math.random().toString(36).substring(7),checkbox='<div class="checkbox"><input type="checkbox" ng-change="checkChange('+row+')" ng-model="checkB['+row+']._checked" id="'+random+row+'" name="'+random+row+'" value="'+row+'"><label for="'+random+row+'"></label></div>';return checkbox}function createBody(table,content){if(scope.tinkHeaders instanceof Array&&content instanceof Array)for(var body=table.createTBody(),i=scope.tinkHeaders.length-1;i>=0;i--)for(var j=0;j<content.length;j++){var row;if(body.rows[j])row=body.rows[j];else if(row=body.insertRow(j),$(row).attr("ng-click","rowClick("+j+")"),scope.hasAction()){var check=row.insertCell(0);check.innerHTML=createCheckbox(j,j),$(check).attr("ng-click","preventEvent($event)")}var fieldExpression=scope.tinkHeaders[i].field,fieldNames=scope.tinkHeaders[i].field.split("+");angular.forEach(fieldNames,function(fieldName){if(fieldName=fieldName.trim(),fieldName.indexOf('"')<0){var splittedFieldNames=fieldName.split("."),fieldValue=content[j];angular.forEach(splittedFieldNames,function(splittedFieldName){fieldValue=fieldValue[splittedFieldName]}),fieldExpression=null===fieldValue||void 0===fieldValue?fieldExpression.replace(fieldName,'"-"'):fieldExpression.replace(fieldName,'"'+fieldValue+'"')}});var fieldValueComplete=eval(fieldExpression),cell;cell=scope.hasAction()?row.insertCell(1):row.insertCell(0),$(cell).attr("ng-if","tinkHeaders["+i+"].checked"),scope.tinkHeaders[i].filter?cell.innerHTML=$filter(scope.tinkHeaders[i].filter)(fieldValueComplete,scope.tinkHeaders[i].filterArg):cell.innerHTML=fieldValueComplete}}function changeAction(){if(scope.tinkActions instanceof Array){scope.viewActions=[];for(var i=0;i<scope.tinkActions.length;i++){var action=scope.tinkActions[i];scope.viewActions.push({name:action.name,callback:function(){for(var checked=[],i=0;i<scope.ngModel.length;i++)scope.checkB[i]&&scope.checkB[i]._checked===!0&&checked.push(scope.ngModel[i]);scope.close(),action.callback(checked,uncheckAll)}})}}}function createHeaders(tableEl,headers){if(scope.tinkHeaders instanceof Array&&headers instanceof Array){var header=tableEl.createTHead(),row=header.insertRow(0);if(scope.hasAction()){var thCheck=document.createElement("th");thCheck.setAttribute("class","has-checkbox"),thCheck.innerHTML=createCheckbox(-1,-1,"hulp"),row.appendChild(thCheck)}for(var i=0;i<headers.length;i++){var val=headers[i].alias||headers[i].field,th=document.createElement("th");th.innerHTML=val,$(th).attr("ng-if","tinkHeaders["+i+"].checked"),headers[i].sort&&$(th).attr("tink-sort-header",headers[i].field),row.appendChild(th)}}}function fullChecked(){for(var length=0,i=0;i<scope.ngModel.length;i++)scope.checkB[i]&&scope.checkB[i]._checked&&(length+=1);scope.checkB[-1]||(scope.checkB[-1]={}),0!==length?scope.selectedCheck=!0:scope.selectedCheck=!1,length===scope.ngModel.length?scope.checkB[-1]._checked=!0:scope.checkB[-1]._checked=!1}function uncheckAll(){for(var i=0;i<scope.ngModel.length;i++)scope.checkB[i]&&scope.checkB[i]._checked===!0&&(scope.checkB[i]._checked=!1);scope.checkB[-1]&&(scope.checkB[-1]._checked=!1)}scope.checkB=[];var currentSort={field:null,order:null};scope.hasAction=function(){return scope.viewActions&&scope.viewActions instanceof Array&&scope.viewActions.length>0?!0:!1},scope.hasReorder=function(){return scope.tinkColumnReorder===!1||"false"===scope.tinkColumnReorder?!1:!0},scope.forceResponsive=function(){return scope.tinkForceResponsive===!0||"true"===scope.tinkForceResponsive?!0:!1},scope.buildTable=function(){if(scope.ngModel){changeAction();var tableEl=element.find("table"),table=document.createElement("table");$(tableEl).addClass("table-interactive"),$(tableEl).attr("tink-callback","sortHeader($property,$order,$type)"),createHeaders(table,scope.tinkHeaders),createBody(table,scope.ngModel),scope.checkB=scope.createArray(scope.ngModel.length),fullChecked(),tableEl.children("thead").html($(table).children("thead").children()),tableEl.children("tbody").html($(table).children("tbody").children()),$compile(tableEl.children("thead"))(scope),$compile(tableEl.children("tbody"))(scope)}},scope.rowClick=function(i){scope.tinkRowClick.call(null,{$element:scope.ngModel[i]})},scope.preventEvent=function(event){event.stopPropagation()},scope.sortHeader=function(field,order,type){currentSort={},currentSort.field=field,currentSort.type=type,currentSort.order=order,scope.tinkChange({$property:field,$order:order,$type:type})},scope.createArray=function(num){for(var array=[],i=0;num>i;i++)array[i]={};return array},scope.checkChange=function(i){if(-1===i){var check=scope.checkB[-1]._checked;angular.forEach(scope.checkB,function(val){val._checked=check,scope.selectedCheck=check})}else scope.checkB[-1]&&(scope.checkB[-1]._checked=!1),fullChecked()},scope.arrowUp=function(){scope.selected>0&&(scope.tinkHeaders.swap(scope.selected,scope.selected-1),scope.selected-=1,scope.buildTable())},scope.arrowDown=function(){scope.selected<scope.tinkHeaders.length-1&&(scope.tinkHeaders.swap(scope.selected,scope.selected+1),scope.selected+=1,scope.buildTable())},scope.close=function(){$rootScope.$broadcast("popover-open",{group:"option-table",el:$("<div><div>")})},scope.headerChange=function(){scope.buildTable()},scope.select=function(e,index){e.preventDefault(),scope.selected=index},scope.$watch("ngModel",function(){scope.buildTable()},!0),Array.prototype.swap=function(a,b){var temp=this[a];this[a]=this[b],this[b]=temp}}}}]).directive("tinkShiftSort",["$timeout",function(timeout){return{restirct:"A",link:function(scope,elem){timeout(function(){Sortable.create(elem.find("ul").get(0),{ghostClass:"draggable-placeholder",animation:200,handle:".draggable-elem",onStart:function(evt){scope.$apply(function(){scope.selected=evt.oldIndex})},onUpdate:function(evt){scope.$apply(function(){var old=scope.tinkHeaders[evt.oldIndex];scope.tinkHeaders.splice(evt.oldIndex,1),scope.tinkHeaders.splice(evt.newIndex,0,old),scope.selected=evt.newIndex,scope.buildTable()})}})},200)}}}])}(),angular.module("tink.interactivetable").run(["$templateCache",function($templateCache){$templateCache.put("templates/pagination.html",'<div class=table-sort-options> <div class=table-sort-info> <strong>{{tinkItemsPerPage*(tinkCurrentPage-1)+1 | tinkMin:1}} - {{tinkItemsPerPage*tinkCurrentPage | limitNum:tinkTotalItems | tinkMin:tinkItemsPerPage}}</strong> van {{tinkTotalItems}} <div class=select> <select data-ng-change=ctrl.perPageChange() data-ng-model=tinkItemsPerPage> <option data-ng-repeat="items in ctrl.itemsPerPage()">{{items}}</option> </select> items per pagina </div> </div> <div class=table-sort-pagination> <ul class=pagination> <li class=prev data-ng-class="{disabled:tinkCurrentPage===1}" data-ng-click="tinkCurrentPage===1 || ctrl.setPrev()" ng-disabled="tinkCurrentPage===1"><a href=""><span>Vorige</span></a></li> <li data-ng-class="{active:tinkCurrentPage===1}" data-ng-click=ctrl.setPage(1)><a href="">1</a></li> <li data-ng-repeat="pag in ctrl.calculatePages() track by $index" data-ng-class="{active:pag===tinkCurrentPage}" data-ng-click="pag === -1 || ctrl.setPage(pag)"><a href="" data-ng-if="pag !== -1">{{pag}}</a> <span data-ng-show="pag === -1">...<span></span></span></li> <li class=next data-ng-click="tinkCurrentPage===ctrl.pages || ctrl.setNext()" data-ng-class="{disabled:tinkCurrentPage===ctrl.pages}" ng-disabled="tinkCurrentPage===ctrl.pages"><a href=""><span>Volgende</span></a></li> </ul> </div> </div>'),$templateCache.put("templates/reorder.html",' <div class=bar> <div class=bar-section>  <ul class=bar-section-right> <li> <button data-ng-if="hasAction() && selectedCheck" tink-popover tink-popover-group=option-table tink-popover-template=templates/tinkTableAction.html>Acties <i class="fa fa-caret-down"></i></button> </li> <li> <button data-ng-if=hasReorder() tink-popover tink-popover-group=option-table tink-popover-template=templates/tinkTableShift.html>Kolommen <i class="fa fa-caret-down"></i></button> </li> </ul> </div> </div>  <table id=theInteractiveTable tink-sort-table=ngModel tink-sort=false tink-callback=sortHeader($property,$order,$type) class=table-interactive tink-pagination-key=directivePag data-ng-class="{\'table-force-responsive\': forceResponsive()}"> <thead> </thead> <tbody> </tbody> </table> <div data-ng-if="ngModel.length === 0" class=table-message>{{tinkEmptyMessage}}</div> '),$templateCache.put("templates/tinkTableAction.html",'<ul class="popover-list-buttons ng-scope"> <li data-ng-repeat="action in viewActions"><a href="" data-ng-click=action.callback()>{{action.name}}</a></li> </ul>'),$templateCache.put("templates/tinkTableShift.html",'<div class=table-interactive-options tink-shift-sort>  <div class=table-interactive-sort> <button class=btn-borderless ng-disabled="selected<1" ng-click=arrowUp()><i class="fa fa-arrow-up"> </i></button>\n<button class=btn-borderless ng-disabled="selected<0 || selected === headers.length-1" ng-click=arrowDown()><i class="fa fa-arrow-down"></i></button> </div>  <ul ng-model=tinkHeaders class=table-interactive-cols> <li ng-repeat="header in tinkHeaders"> <div class="checkbox is-selectable is-draggable" ng-class="{selected:selected===$index}"> <input type=checkbox ng-model=header.checked id={{header.alias}} name={{header.alias}} value={{header.alias}} checked> <label for={{header.alias}}><span class=draggable-elem ng-class="{selected:selected===$index}" ng-click=select($event,$index)>{{header.alias}}</span></label> </div> </li> </ul> <div class=table-interactive-sort>  <button class=btn-xs ng-click=close()>Sluiten</button> </div> </div>')}]);
//# sourceMappingURL=tink-interactive-table-angular.min.map